clear;
R = [448.00, 454.00, 448.00, 446.00, 450.00, 452.00, 447.00, 446.00, 451.00, 450.00, 445.00, 446.00, 450.00, 449.00, 443.00, 447.00, 450.00, 445.00, 442.00, 447.00, 451.00, 446.00, 444.00, 449.00, 449.00, 444.00, 447.00, 451.00, 447.00, 443.00, 447.00, 449.00, 444.00, 442.00, 449.00, 449.00, 442.00, 443.00, 447.00, 445.00, 442.00, 445.00, 448.00, 442.00, 441.00, 445.00, 445.00, 447.00, 442.00, 439.00, 445.00, 446.00, 442.00, 441.00, 446.00, 444.00, 439.00, 441.00, 447.00, 442.00, 439.00, 442.00, 445.00, 438.00, 439.00, 444.00, 440.00, 437.00, 439.00, 447.00, 444.00, 439.00, 440.00, 445.00, 442.00, 436.00, 442.00, 441.00, 438.00, 436.00, 441.00, 444.00, 435.00, 437.00, 442.00, 441.00, 436.00, 438.00, 443.00, 438.00, 435.00, 440.00, 442.00, 435.00, 435.00, 442.00, 442.00, 434.00, 439.00, 443.00, 440.00, 433.00, 435.00, 442.00, 435.00, 433.00, 437.00, 438.00, 433.00, 431.00, 431.00, 438.00, 439.00, 432.00, 433.00, 438.00, 436.00, 431.00, 434.00, 437.00, 432.00, 427.00, 435.00, 436.00, 432.00, 432.00, 436.00, 437.00, 432.00, 433.00, 437.00, 434.00, 430.00, 434.00, 437.00, 434.00, 430.00, 434.00, 438.00, 434.00, 430.00, 439.00, 437.00, 429.00, 433.00, 439.00, 436.00, 431.00, 439.00, 440.00, 434.00, 434.00, 437.00, 438.00, 432.00, 432.00, 438.00, 436.00, 430.00, 432.00, 439.00, 433.00, 429.00, 434.00, 437.00, 431.00, 429.00, 433.00, 434.00, 429.00, 430.00, 434.00, 433.00, 428.00, 428.00, 431.00, 435.00, 432.00, 429.00, 433.00, 436.00, 429.00, 429.00, 434.00, 435.00, 429.00, 428.00, 433.00, 431.00, 426.00, 427.00, 432.00, 426.00, 423.00, 430.00, 431.00, 426.00, 426.00, 430.00, 432.00, 424.00, 425.00, 430.00, 429.00, 422.00, 427.00, 429.00, 424.00, 420.00, 425.00, 430.00, 426.00, 422.00, 428.00, 430.00, 422.00, 423.00, 429.00, 428.00, 421.00, 426.00, 431.00, 425.00, 422.00, 428.00, 431.00, 423.00, 422.00, 428.00, 427.00, 425.00, 425.00, 431.00, 428.00, 423.00, 427.00, 431.00, 428.00, 428.00, 423.00, 427.00, 432.00, 425.00, 421.00, 429.00, 430.00, 421.00, 423.00, 427.00, 425.00, 420.00, 423.00, 428.00, 424.00, 419.00, 424.00, 429.00, 421.00, 418.00, 424.00, 426.00, 420.00, 422.00, 427.00, 424.00, 420.00, 423.00, 429.00, 423.00, 420.00, 426.00, 429.00, 420.00, 419.00, 426.00, 426.00, 419.00, 419.00, 426.00, 423.00, 418.00, 421.00, 426.00, 420.00, 416.00, 424.00, 426.00, 422.00, 419.00, 425.00, 426.00, 419.00, 423.00, 428.00, 427.00, 420.00, 424.00, 427.00, 421.00, 420.00, 426.00, 427.00, 427.00, 421.00, 423.00, 426.00, 426.00, 421.00, 423.00, 429.00, 426.00, 422.00, 426.00, 429.00, 426.00, 424.00, 426.00, 431.00, 425.00, 424.00, 430.00, 431.00, 426.00, 424.00, 429.00, 429.00, 423.00, 427.00, 433.00, 426.00, 425.00, 431.00, 433.00, 426.00, 425.00, 432.00, 431.00, 425.00, 427.00, 434.00, 431.00, 426.00, 430.00, 435.00, 429.00, 424.00, 430.00, 433.00, 426.00, 426.00, 433.00, 433.00, 426.00, 426.00, 434.00, 432.00, 427.00, 431.00, 435.00, 431.00, 427.00, 434.00, 435.00, 427.00, 429.00, 434.00, 434.00, 433.00, 428.00, 427.00, 433.00, 432.00, 428.00, 430.00, 436.00, 432.00, 430.00, 435.00, 436.00, 430.00, 427.00, 435.00, 433.00, 427.00, 429.00, 437.00, 432.00, 426.00, 433.00, 435.00, 431.00, 430.00, 433.00, 436.00, 428.00, 430.00, 435.00, 435.00, 432.00, 431.00, 439.00, 434.00, 429.00, 433.00, 438.00, 432.00, 431.00, 436.00, 436.00, 431.00, 430.00, 437.00, 437.00, 430.00, 432.00, 438.00, 436.00, 431.00, 436.00, 440.00, 436.00, 433.00, 436.00, 440.00, 432.00, 431.00, 437.00, 438.00, 434.00, 433.00, 433.00, 438.00, 437.00, 431.00, 436.00, 442.00, 435.00, 434.00, 437.00, 439.00, 435.00, 434.00, 443.00, 440.00, 436.00, 438.00, 444.00, 441.00, 434.00, 440.00, 444.00, 437.00, 435.00, 441.00, 444.00, 437.00, 436.00, 440.00, 440.00, 434.00, 435.00, 444.00, 438.00, 435.00, 440.00, 443.00, 439.00, 436.00, 441.00, 443.00, 438.00, 436.00, 445.00, 443.00, 436.00, 439.00, 446.00, 446.00, 437.00, 442.00, 446.00, 443.00, 439.00, 446.00, 446.00, 439.00, 440.00, 446.00, 445.00, 439.00, 443.00, 448.00, 443.00, 440.00, 440.00, 445.00, 446.00, 439.00, 439.00, 447.00, 445.00, 441.00, 441.00, 447.00, 445.00, 439.00, 441.00, 447.00, 444.00, 440.00, 443.00, 448.00 ];
ARM_OUT = [867.98, 9.90, 0.62, 1.70, 0.29, 0.59, 0.60, 0.65, 0.17, 0.16, 0.09, 0.31, 0.44, 0.10, 0.38, 0.25, 0.18, 0.39, 0.19, 0.19, 0.12, 0.29, 0.20, 0.33, 0.05, 0.15, 0.18, 0.03, 0.12, 0.29, 0.03, 0.16, 0.19, 0.06, 0.11, 0.14, 0.08, 0.24, 0.09, 0.06, 0.08, 0.13, 0.14, 0.04, 0.22, 0.24, 0.10, 0.13, 0.08, 0.11, 0.02, 0.07, 0.03, 0.19, 0.10, 0.03, 0.00, 0.18, 0.08, 0.16, 0.05, 0.05, 0.10, 0.16, 0.09, 0.09, 0.08, 0.03, 0.10, 0.01, 0.11, 0.05, 0.12, 0.26, 0.08, 0.07, 0.02, 0.06, 0.16, 0.19, 0.11, 0.07, 0.05, 0.11, 0.12, 0.10, 0.11, 0.16, 0.19, 0.07, 0.10, 0.12, 0.02, 0.12, 0.11, 0.18, 0.10, 0.08, 0.12, 0.05, 0.12, 0.13, 0.36, 0.07, 0.08, 0.05, 0.04, 0.11, 0.07, 0.05, 0.10, 0.14, 0.15, 0.11, 0.15, 0.17, 0.10, 0.09, 0.04, 0.42, 0.23, 0.24, 0.13, 0.17, 0.22, 0.21, 0.46, 0.46, 0.28, 0.22, 0.15, 0.26, 0.45, 0.68, 2.19, 2.39, 0.77, 0.48, 0.34, 0.35, 0.24, 0.24, 0.85, 1.06, 0.31, 0.10, 0.15, 0.21, 0.17, 0.07, 0.45, 0.33, 0.28, 0.15, 0.28, 0.10, 0.14, 0.11, 0.25, 0.22, 0.17, 0.02, 0.09, 0.05, 0.09, 0.09, 0.13, 0.16, 0.15, 0.05, 0.11, 0.14, 0.03, 0.02, 0.17, 0.25, 0.08, 0.16, 0.09, 0.07, 0.06, 0.09, 0.12, 0.15, 0.04, 0.09, 0.18, 0.11, 0.09, 0.13, 0.08, 0.05, 0.12, 0.08, 0.04, 0.10, 0.05, 0.13, 0.08, 0.12, 0.04, 0.12, 0.02, 0.07, 0.03, 0.03, 0.11, 0.05, 0.09, 0.12, 0.13, 0.11, 0.11, 0.18, 0.10, 0.02, 0.07, 0.09, 0.16, 0.07, 0.13, 0.09, 0.04, 0.04, 0.07, 0.11, 0.15, 0.07, 0.07, 0.00, 0.12, 0.10, 0.01, 0.08, 0.16, 0.05, 0.01, 0.03, 0.06, 0.05, 0.06, 0.09, 0.06, 0.10, 0.02, 0.07, 0.02, 0.09, 0.09, 0.09, 0.04, 0.05, 0.07, 0.04, 0.05,  0.07 ];
L=length(R);
plotsMax=5;

fs=4E6/96;
dt=1/fs; %time.
t=(0:1:L-1)*dt; %If you'd like to plot the time signal: plot(t,R)
%R=2*sin(18000*2*pi*t) + sin(10000*pi*2*t);
subplot(plotsMax,1,1)
plot(t,R)

outCalc= 2 * abs(fft(R))/L;
outputLenght = length(outCalc)/2;

%use the sample_offset value to offset the DC magitude in the plot. 
sample_offset=3;
index=sample_offset:outputLenght;
x=fs/2*linspace(0,1,outputLenght+1);
y= outCalc(1:outputLenght);
z=(ARM_OUT(1:outputLenght));

subplot(plotsMax,1,2)
plot(x(index), y(index), title('One sided Spectrum with DC offset'))
xlabel('Normalized frequency - Y')
ylabel('Magnitude')

subplot(plotsMax,1,3)
plot(x(index), z(index), title('ARM sided Spectrum with DC offset'))
xlabel('Normalized frequency - Z')
ylabel('Magnitude')

subplot(plotsMax,1,4)
plot(x(index), y(index), title('One sided Spectrum with DC'))
xlabel('Normalized frequency - Y')
ylabel('Magnitude')

subplot(plotsMax,1,5)
plot(x(index), ARM_OUT(index), title('ARM FFT result'))
xlabel('Normalized frequency - ARM OUT')
ylabel('Magnitude')

